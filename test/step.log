-- FreeFem++ v4.6 (Fri, Apr 03, 2020  2:08:08 PM - git v4.6)
 Load: lg_fem lg_mesh lg_mesh3 eigenvalue
    1 : // Libraries
    2 : load "iovtk"(load: loadLibary D:\Arquivos de Programas\FreeFem++\\.\iovtk = 0) load: iovtk
 
    3 :
    4 : //Parameters
    5 : int i = 0;
    6 : int h = 1;
    7 : int j = 2;
    8 : int n = 10;
    9 :
   10 : // Mesh
   11 : border a(t=h, j) {x=t; y=0;}        //Bottom
   12 : border b(t=i, j) {x=2; y=t;}        //Right
   13 : border c(t=i, j) {x=2-t; y=2;}      //Top
   14 : border d(t=i, h) {x=0; y=2-t;}      //Top left
   15 : border e(t=i, h) {x=t; y=1;}        //mid
   16 : border f(t=i, h) {x=1; y=1-t;}      //Bottom left
   17 :
   18 :
   19 : // Plot mesh
   20 : mesh Th = buildmesh(a(n) + b(n) + c(n) + d(n) + e(n) + f(n));
   21 :
   22 : plot(Th, wait=0, fill=0);
   23 :
   24 : // Functions space
   25 : fespace Vh(Th, [P1,P1]);
   26 : Vh [vx, vy], [vxTeste, vyTeste];
   27 :
   28 : // Boundary Conditions
   29 : func parabola = -3*(y-1)*(y-2);
   30 : func bottomvelocity = 0.5 * (y);
   31 :
   32 :
   33 : solve velocity([vx, vy], [vxTeste, vyTeste]) =
   34 :     int2d(Th)(dx(vx)*dx(vxTeste) + dx(vy)*dx(vyTeste) +
   35 :               dy(vx)*dy(vxTeste) + dy(vy)*dy(vyTeste)) +
   36 :     on(a, c, e, f, vx=0, vy=0) +
   37 :     on(d, vx=parabola, vy=bottomvelocity) +
   38 :     int2d(Th, b)(vxTeste + vyTeste);
   39 :
   40 : // Plot
   41 : plot([vx, vy], wait=1, fill=1, value=true, cmm="Step");
   42 :
   43 : // Alternative
   44 : // plot(vx, wait=1, fill=1, cmm="Velocity in x");
   45 : // plot(vy, wait=1, fill=1, cmm="Velocity in y");
   46 :
   47 : savevtk("D:/Documentos/Permanent-heat-conduction/data/step
  ... : .vtk", Th, [vx, vy]);
   48 :
   49 : // Save archive in txt
   50 : ofstream dataStep("D:/Documentos/Permanent-heat-conduction/data/data
  ... : _step.txt");
   51 :
   52 : dataStep << "x                      |y                      |v
  ... : x                     |vy         " << endl;
   53 :
   54 : for (int i = 0; i < Th.nv; i++) {
   55 :     real xVal = Th(i).x;
   56 :     real yVal = Th(i).y;
   57 :     real vxVal = vx[](i);
   58 :     real vyVal = vy[](i);
   59 :
   60 :     dataStep << xVal << "                   |" << yVal << "                     |" << vxVal << "
        |" << vyVal << endl;
   61 : }
   62 :
   63 : cout << "Arquivo 'data_step.txt' salvo com sucesso!" << endl; sizestack + 1024 =2016  ( 992 )
 
  --  mesh:  Nb of Triangles =    340, Nb of Vertices 201
  -- Solve :
          min 1.17775e-64  max 1
 0x82b400 VTK_FILE 1
Arquivo 'data_step.txt' salvo com sucesso!
times: compile 0.072s, execution 0.057s,  mpirank:0
 ######## We forget of deleting   -606 Nb pointer,   0Bytes  ,  mpirank 0, memory leak =0
 CodeAlloc : nb ptr  3764,  size :484496 mpirank: 0
Ok: Normal End
 try getConsole D:\Documentos\Permanent-heat-conduction\step.edp
